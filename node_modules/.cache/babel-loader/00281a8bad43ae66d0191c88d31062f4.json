{"ast":null,"code":"import './theme/styles.css';\nimport { BrowserRouter, Route, Routes } from \"react-router-dom\";\nimport Home from './screens/Home';\nimport Books from './screens/Books';\nimport Addauthors from './screens/AddAuthors';\nimport { Login } from './screens/Login';\nimport { useState } from 'react';\nimport { Sidebar } from './components/Sidebar';\n\nclass App extends Component {\n  constructor() {\n    super(...arguments);\n    this.state = {\n      showBackdrop: false,\n      showMobileNav: false,\n      isAuth: true,\n      token: null,\n      userId: null,\n      authLoading: false,\n      error: null\n    };\n\n    this.mobileNavHandler = isOpen => {\n      this.setState({\n        showMobileNav: isOpen,\n        showBackdrop: isOpen\n      });\n    };\n\n    this.backdropClickHandler = () => {\n      this.setState({\n        showBackdrop: false,\n        showMobileNav: false,\n        error: null\n      });\n    };\n\n    this.logoutHandler = () => {\n      this.setState({\n        isAuth: false,\n        token: null\n      });\n      localStorage.removeItem('token');\n      localStorage.removeItem('expiryDate');\n      localStorage.removeItem('userId');\n    };\n\n    this.loginHandler = (event, authData) => {\n      event.preventDefault();\n      this.setState({\n        authLoading: true\n      });\n      fetch('URL').then(res => {\n        if (res.status === 422) {\n          throw new Error('Validation failed.');\n        }\n\n        if (res.status !== 200 && res.status !== 201) {\n          console.log('Error!');\n          throw new Error('Could not authenticate you!');\n        }\n\n        return res.json();\n      }).then(resData => {\n        console.log(resData);\n        this.setState({\n          isAuth: true,\n          token: resData.token,\n          authLoading: false,\n          userId: resData.userId\n        });\n        localStorage.setItem('token', resData.token);\n        localStorage.setItem('userId', resData.userId);\n        const remainingMilliseconds = 60 * 60 * 1000;\n        const expiryDate = new Date(new Date().getTime() + remainingMilliseconds);\n        localStorage.setItem('expiryDate', expiryDate.toISOString());\n        this.setAutoLogout(remainingMilliseconds);\n      }).catch(err => {\n        console.log(err);\n        this.setState({\n          isAuth: false,\n          authLoading: false,\n          error: err\n        });\n      });\n    };\n\n    this.signupHandler = (event, authData) => {\n      event.preventDefault();\n      this.setState({\n        authLoading: true\n      });\n      fetch('URL').then(res => {\n        if (res.status === 422) {\n          throw new Error(\"Validation failed. Make sure the email address isn't used yet!\");\n        }\n\n        if (res.status !== 200 && res.status !== 201) {\n          console.log('Error!');\n          throw new Error('Creating a user failed!');\n        }\n\n        return res.json();\n      }).then(resData => {\n        console.log(resData);\n        this.setState({\n          isAuth: false,\n          authLoading: false\n        });\n        this.props.history.replace('/');\n      }).catch(err => {\n        console.log(err);\n        this.setState({\n          isAuth: false,\n          authLoading: false,\n          error: err\n        });\n      });\n    };\n\n    this.setAutoLogout = milliseconds => {\n      setTimeout(() => {\n        this.logoutHandler();\n      }, milliseconds);\n    };\n\n    this.errorHandler = () => {\n      this.setState({\n        error: null\n      });\n    };\n  }\n\n  componentDidMount() {\n    const token = localStorage.getItem('token');\n    const expiryDate = localStorage.getItem('expiryDate');\n\n    if (!token || !expiryDate) {\n      return;\n    }\n\n    if (new Date(expiryDate) <= new Date()) {\n      this.logoutHandler();\n      return;\n    }\n\n    const userId = localStorage.getItem('userId');\n    const remainingMilliseconds = new Date(expiryDate).getTime() - new Date().getTime();\n    this.setState({\n      isAuth: true,\n      token: token,\n      userId: userId\n    });\n    this.setAutoLogout(remainingMilliseconds);\n  }\n\n  render() {\n    return aaa;\n  }\n\n}\n\nexport default _c = withRouter(App);\n\nvar _c;\n\n$RefreshReg$(_c, \"%default%\");","map":{"version":3,"sources":["C:/Users/iraka/OneDrive/Desktop/ira-front/src/App.js"],"names":["BrowserRouter","Route","Routes","Home","Books","Addauthors","Login","useState","Sidebar","App","Component","state","showBackdrop","showMobileNav","isAuth","token","userId","authLoading","error","mobileNavHandler","isOpen","setState","backdropClickHandler","logoutHandler","localStorage","removeItem","loginHandler","event","authData","preventDefault","fetch","then","res","status","Error","console","log","json","resData","setItem","remainingMilliseconds","expiryDate","Date","getTime","toISOString","setAutoLogout","catch","err","signupHandler","props","history","replace","milliseconds","setTimeout","errorHandler","componentDidMount","getItem","render","aaa","withRouter"],"mappings":"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","sourcesContent":["import './theme/styles.css';\r\nimport {\r\n  BrowserRouter,\r\n  Route,\r\n  Routes\r\n} from \"react-router-dom\";\r\nimport Home from './screens/Home';\r\nimport Books from './screens/Books';\r\nimport Addauthors from './screens/AddAuthors';\r\nimport { Login } from './screens/Login';\r\nimport { useState } from 'react';\r\nimport { Sidebar } from './components/Sidebar';\r\n\r\nclass App extends Component {\r\n  state = {\r\n    showBackdrop: false,\r\n    showMobileNav: false,\r\n    isAuth: true,\r\n    token: null,\r\n    userId: null,\r\n    authLoading: false,\r\n    error: null\r\n  };\r\n\r\n  componentDidMount() {\r\n    const token = localStorage.getItem('token');\r\n    const expiryDate = localStorage.getItem('expiryDate');\r\n    if (!token || !expiryDate) {\r\n      return;\r\n    }\r\n    if (new Date(expiryDate) <= new Date()) {\r\n      this.logoutHandler();\r\n      return;\r\n    }\r\n    const userId = localStorage.getItem('userId');\r\n    const remainingMilliseconds =\r\n      new Date(expiryDate).getTime() - new Date().getTime();\r\n    this.setState({ isAuth: true, token: token, userId: userId });\r\n    this.setAutoLogout(remainingMilliseconds);\r\n  }\r\n\r\n  mobileNavHandler = isOpen => {\r\n    this.setState({ showMobileNav: isOpen, showBackdrop: isOpen });\r\n  };\r\n\r\n  backdropClickHandler = () => {\r\n    this.setState({ showBackdrop: false, showMobileNav: false, error: null });\r\n  };\r\n\r\n  logoutHandler = () => {\r\n    this.setState({ isAuth: false, token: null });\r\n    localStorage.removeItem('token');\r\n    localStorage.removeItem('expiryDate');\r\n    localStorage.removeItem('userId');\r\n  };\r\n\r\n  loginHandler = (event, authData) => {\r\n    event.preventDefault();\r\n    this.setState({ authLoading: true });\r\n    fetch('URL')\r\n      .then(res => {\r\n        if (res.status === 422) {\r\n          throw new Error('Validation failed.');\r\n        }\r\n        if (res.status !== 200 && res.status !== 201) {\r\n          console.log('Error!');\r\n          throw new Error('Could not authenticate you!');\r\n        }\r\n        return res.json();\r\n      })\r\n      .then(resData => {\r\n        console.log(resData);\r\n        this.setState({\r\n          isAuth: true,\r\n          token: resData.token,\r\n          authLoading: false,\r\n          userId: resData.userId\r\n        });\r\n        localStorage.setItem('token', resData.token);\r\n        localStorage.setItem('userId', resData.userId);\r\n        const remainingMilliseconds = 60 * 60 * 1000;\r\n        const expiryDate = new Date(\r\n          new Date().getTime() + remainingMilliseconds\r\n        );\r\n        localStorage.setItem('expiryDate', expiryDate.toISOString());\r\n        this.setAutoLogout(remainingMilliseconds);\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n        this.setState({\r\n          isAuth: false,\r\n          authLoading: false,\r\n          error: err\r\n        });\r\n      });\r\n  };\r\n\r\n  signupHandler = (event, authData) => {\r\n    event.preventDefault();\r\n    this.setState({ authLoading: true });\r\n    fetch('URL')\r\n      .then(res => {\r\n        if (res.status === 422) {\r\n          throw new Error(\r\n            \"Validation failed. Make sure the email address isn't used yet!\"\r\n          );\r\n        }\r\n        if (res.status !== 200 && res.status !== 201) {\r\n          console.log('Error!');\r\n          throw new Error('Creating a user failed!');\r\n        }\r\n        return res.json();\r\n      })\r\n      .then(resData => {\r\n        console.log(resData);\r\n        this.setState({ isAuth: false, authLoading: false });\r\n        this.props.history.replace('/');\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n        this.setState({\r\n          isAuth: false,\r\n          authLoading: false,\r\n          error: err\r\n        });\r\n      });\r\n  };\r\n\r\n  setAutoLogout = milliseconds => {\r\n    setTimeout(() => {\r\n      this.logoutHandler();\r\n    }, milliseconds);\r\n  };\r\n\r\n  errorHandler = () => {\r\n    this.setState({ error: null });\r\n  };\r\n\r\n  render() {\r\n  \r\n     \r\n    return (\r\n      aaa\r\n      \r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(App);\r\n\r\n"]},"metadata":{},"sourceType":"module"}